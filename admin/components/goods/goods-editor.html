<div ng-init="product = $ctrl.product" ng-switch="$ctrl.editMode">
    <div class="btn_control">
        <button class="btn btn-default" ng-click="$ctrl.edit()">Preview</button>
        <button class="btn btn-default" ng-click="$ctrl.save()">Save</button>
    </div>
    <div class="card" ng-switch-when="false">
        <div class="row">
            <div class="col-lg-5 col-md-5 col-sm-5 col-xs-12">
                <zoom mark-height="100" mark-width="100" src="{{'/api/file/' + $ctrl.preview.uuid}}" zoom-lvl="4"></zoom>
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <div class="galleryWrap">
                            <div class="imageWrap" ng-repeat="photo in product.gallery">
                                <img class="cover img-responsive img-thumbnail" src="{{'/api/file/' + photo.uuid}}" ng-click="$ctrl.preview = photo" alt="">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-7 col-md-7 col-sm-7 col-xs-12">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <p class="categCard">{{ product.category }}</p>
                        <div class="artNameCard">
                            <div>Артикул {{ product.article }}</div>
                            <p id="goodNameCard">{{ product.name }}</p>
                        </div>
                        <div class="descriptionCard">
                            {{ product.description }}
                        </div>
                        <div class="priceCard"><span>{{ product.stock?$ctrl.stockCost:product.price }} грн</span>
                            <strike ng-if="product.stock">{{ product.price }}</strike>
                        </div>
                        <hr class="marCard"/>
                        <div class="sizeCard">Размер
                            <div class="sizeCardDis">
                                <div class="checkbo" ng-repeat="(key, value) in product.size">
                                    <input type="checkbox" id="{{key}}" name="option" value="a"/>
                                    <label for="{{key}}"></label><span>{{value}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <ul role="tablist" class="nav nav-tabs">
                    <li role="presentation" class="active"><a href="#about" aria-controls="home" role="tab" data-toggle="tab">О товаре</a></li>
                    <li role="presentation"><a href="#comm" aria-controls="profile" role="tab" data-toggle="tab">Отзывы</a></li>
                </ul>
                <div class="tab-content">
                    <div id="about" role="tabpanel" class="tab-pane active">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <table class="table">
                                    <tbody>
                                    <tr ng-repeat="sub in product.sublines">
                                        <td>{{sub.name}}</td>
                                        <td>{{sub.value}}</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div id="comm" role="tabpanel" class="tab-pane">222</div>
                </div>
            </div>
        </div>
    </div>
    <div class="card prodEdit" ng-switch-when="true">
        <div class="row">
            <div class="col-lg-5 col-md-5 col-sm-5 col-xs-12">
                <label>Галерея</label>
                <div ng-include="'admin/components/common/upload-template.html'" ng-init="uploader = $ctrl.uploader"></div>
                <table class="table" ng-hide="$ctrl.addingGallery || product.gallery.length == 0 && !product.photo">
                    <thead>
                        <tr>
                            <th>Имя</th>
                            <th>Обложка</th>
                            <th>Удалить</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="photo in product.gallery">
                            <td>
                                <strong class="name_goods">{{photo.name}}</strong>
                                <img src="{{'/api/file/' + photo.uuid}}" alt="" width="120" height="80" style="object-fit: cover;">
                            </td>
                            <td class="text-center">
                                <input type="radio" style="margin: 0 auto; display: block;" id="main" name="main" ng-checked="photo.type == 'main'"/>
                            </td>
                            <td>
                                <button type="button" class="btn btn-danger btn-xs" ng-click="$ctrl.remove(photo)">
                                    <span class="glyphicon glyphicon-trash"></span></button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-lg-7 col-md-7 col-sm-7 col-xs-12">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <p class="categCard">
                            <label>Категория</label>
                            <treecontrol ng-if="$ctrl.categories" class="tree-light" tree-model="$ctrl.categories" selected-node="$ctrl.selected" expanded-nodes="$ctrl.selected"  on-selection="$ctrl.addCategToProduct(node)">
                                {{node.name}}
                            </treecontrol>
                        </p>
                        <div class="form-group">
                            <label>Артикул</label>
                            <input class="form-control" ng-model="product.article" placeholder="Артикул">
                        </div>
                        <div class="form-group">
                            <label>Название</label>
                            <input class="form-control" ng-model="product.name" type="text" placeholder="Название">
                        </div>
                        <div class="form-group">
                            <label>Описание</label>
                            <textarea class="form-control" placeholder="Описание" rows="4" cols="45" ng-model="product.description"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Цена</label>
                            <input class="form-control" type="text" placeholder="Цена" ng-model="product.price" ng-change="product.stock != 'stock.uuid'?$ctrl.stockFun(product.stock.percent, product.price):''">
                        </div>
                        <div class="form-group" ng-if="$ctrl.curStock != null">
                            <label>Цена со скидкой</label>
                            <div>{{$ctrl.stockCost}}</div>
                        </div>
                        <div class="form-group">
                            <label>Акция</label>
                            <select class="form-control" ng-model="$ctrl.curStock" ng-options="stock.name for stock in $ctrl.stocks" ng-change="$ctrl.stockFun($ctrl.curStock.percent, product.price)">
                                <!--<option ng-repeat="stock in $ctrl.stocks" value="{{stock}}">{{stock}}</option>-->
                            </select>
                        </div>
                        <div class="form-group" ng-repeat="combo in $ctrl.combinations">
                            <label style="width: 100%">{{combo.name}} <i class="fa viewCombo" ng-class="pror[$index].check?'fa-minus':'fa-plus'" ng-click="pror[$index].check = !pror[$index].check" aria-hidden="true"></i> <i class="fa fa-close viewCombo pull-right" ng-click="$ctrl.delCombo(product, combo.slug)"></i></label>
                            <div ng-if="pror[$index].check">
                                <select  class="form-control" id="inputMultiple" multiple="multiple" ng-model="product.combo[combo.slug].values" ng-change="$ctrl.view(product)">
                                    <option ng-repeat="value in combo.value">{{value}}</option>
                                </select>
                                <small>Зажмите кнопку 'Ctrl' для выбора нескольких пунктов</small>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="form-group">
                    <label>Дополнительные поля</label>
                    <div ng-hide="sub" class="form-group">
                        <button  type="submit" class="btn btn-default" ng-click="sub = !sub">Добавить поле</button>
                    </div>
                    <form class="form-inline" ng-show="sub">
                        <div class="form-group">
                            <label>Заголовок</label>
                            <input type="text" class="form-control" ng-model="nameSub">
                        </div>
                        <div class="form-group" style="margin-left: 20px">
                            <label>Значение</label>
                            <input type="text" class="form-control" ng-model="valueSub">
                        </div>
                        <button type="submit" class="btn btn-default" ng-click="sub = !sub; $ctrl.addSub(nameSub, valueSub); nameSub = null; valueSub = null;">Добавить</button>
                    </form>
                </div>

                <ul role="tablist" class="nav nav-tabs">
                    <li role="presentation" class="active"><a href="#aboutt" aria-controls="home" role="tab" data-toggle="tab">О товаре</a></li>
                    <li role="presentation"><a href="#commm" aria-controls="profile" role="tab" data-toggle="tab">Отзывы</a></li>
                </ul>
                <div class="tab-content">
                    <div id="aboutt" role="tabpanel" class="tab-pane active">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <table class="table">
                                    <tbody>
                                    <tr ng-repeat="sub in product.sublines">
                                        <td>{{sub.name}}</td>
                                        <td>{{sub.value}}</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div id="commm" role="tabpanel" class="tab-pane">222</div>
                </div>
            </div>
        </div>
    </div>
</div>